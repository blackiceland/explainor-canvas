================================================================================
DAEDALUS — Video Factory System
================================================================================

See also: DESIGN_SYSTEM.txt (philosophy), COOKBOOK.txt (code examples)

================================================================================
ARCHITECTURE
================================================================================

core/layouts/    → getSlots('2-col') for positioning
core/beats/      → animation functions (appear, highlight, etc.)
core/themes/     → color/font tokens (OpenStyle, Colors, Timing)
core/validators/ → SafeZone, minFont, timing checks
db/seed.sql      → RAG knowledge (source of truth)

================================================================================
RAG QUERIES (use instead of hardcoding)
================================================================================

rag.search("safe zone")           → screen bounds
rag.search("timing")              → Timing.fast/normal/slow
rag.search("light theme colors")  → OpenStyle tokens
rag.search("dark theme cards")    → PanelStyle tokens
rag.search("beat functions")      → available animations
rag.search("layout presets")      → 2-col, 2L-1R, center, etc.

================================================================================
IMPORTS (don't hardcode values)
================================================================================

import {OpenStyle} from 'core/openStyle';       // light theme
import {Colors, Timing} from 'core/theme';      // dark theme
import {PanelStyle} from 'core/panelStyle';     // dark cards
import {OpenShapes} from 'core/openShapes';     // geometry
import {SafeZone} from 'core/ScreenGrid';       // bounds

================================================================================
RULES FOR AI
================================================================================

DO:
  ✓ Query RAG for concrete values
  ✓ Use getSlots() for positioning
  ✓ Use Timing.fast/normal/slow
  ✓ Use beat functions from core/beats
  ✓ English-only code examples

DON'T:
  ✗ Hardcode colors/sizes/timings
  ✗ Write raw x/y coordinates
  ✗ Position outside SafeZone
  ✗ Mix themes in one scene

================================================================================
RAG ENRICHMENT
================================================================================

After creating scenes, decide if pattern should go into RAG:

ADD if:    REUSABLE (3+ scenes), PROVEN, GENERALIZABLE, NOVEL
SKIP if:   ONE-OFF, EXPERIMENTAL, DUPLICATE, CONTENT-SPECIFIC

Before adding → rag.search() to check duplicates
After adding  → npm run embeddings

Categories: 'rule', 'example', 'philosophy', 'antipattern'

SESSION END CHECKLIST:
  □ New reusable pattern?      → Add to RAG
  □ New antipattern found?     → Add to RAG
  □ Reference-quality scene?   → Add as 'example'
  □ Changed tokens?            → Update knowledge + embeddings

================================================================================
COMMANDS
================================================================================

cd scripts
npm run daedalus:up      # start DB + healthcheck + mock embeddings
npm run healthcheck      # verify DB state
npm run embeddings       # real embeddings (needs OPENAI_API_KEY)
npm run embeddings:mock  # fake embeddings (local dev)
npm run init-db          # re-apply schema+seed

================================================================================
EXTENDING
================================================================================

NEW BEAT:
  1. Add to core/beats/index.ts
  2. INSERT INTO beats in seed.sql
  3. npm run embeddings

NEW LAYOUT:
  1. Add to core/layouts/presets.ts
  2. INSERT INTO layouts in seed.sql
  3. npm run embeddings

NEW RULE:
  1. INSERT INTO knowledge in seed.sql
  2. npm run embeddings

TOKEN CHANGE:
  1. Update core/*.ts
  2. Update knowledge in seed.sql
  3. npm run embeddings

================================================================================
SINGLE SOURCE OF TRUTH
================================================================================

Concrete values live in CODE (tokens) and DB (seed.sql).
Documents describe HOW to find values, not WHAT they are.
If token changes → update seed.sql → regenerate embeddings.

================================================================================
